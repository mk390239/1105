<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>çœŸå®å›ºå®šWebAR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene 
        embedded 
        arjs 
        vr-mode-ui="enabled: false"
    >
        
        <!-- æ ‡è®° -->
        <a-marker preset="hiro" id="marker">
            <a-entity 
                id="model-on-marker"
                gltf-model="4.glb"
                scale="0.01 0.01 0.01"
                visible="true"
            ></a-entity>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // ç®€å•æ–¹æ¡ˆï¼šè®©ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»æ”¾ç½®
        const scene = document.querySelector('a-scene');
        let markerFound = false;
        let fixedModel = null;
        
        scene.addEventListener('click', function(evt) {
            if (markerFound && !fixedModel) {
                // è·å–æ ‡è®°çš„å½“å‰ä½ç½®
                const marker = document.querySelector('#marker');
                const markerPosition = marker.getAttribute('position');
                const markerRotation = marker.getAttribute('rotation');
                
                console.log('æ”¾ç½®æ¨¡å‹åœ¨ä½ç½®:', markerPosition);
                
                // åˆ›å»ºå›ºå®šæ¨¡å‹
                fixedModel = document.createElement('a-entity');
                fixedModel.setAttribute('gltf-model', '4.glb');
                fixedModel.setAttribute('scale', '0.01 0.01 0.01');
                fixedModel.setAttribute('position', markerPosition);
                fixedModel.setAttribute('rotation', markerRotation);
                fixedModel.setAttribute('visible', 'true');
                
                // æ·»åŠ åˆ°åœºæ™¯
                scene.appendChild(fixedModel);
                
                // éšè—æ ‡è®°ä¸Šçš„æ¨¡å‹
                document.querySelector('#model-on-marker').setAttribute('visible', 'false');
                
                console.log('âœ… æ¨¡å‹å·²å›ºå®šåœ¨æ ‡è®°ä½ç½®ï¼');
            }
        });
        
        // æ£€æµ‹æ ‡è®°
        document.querySelector('#marker').addEventListener('markerFound', function() {
            markerFound = true;
            console.log('ğŸ¯ æ ‡è®°å·²è¯†åˆ«ï¼Œç‚¹å‡»å±å¹•å›ºå®šæ¨¡å‹');
        });
        
        document.querySelector('#marker').addEventListener('markerLost', function() {
            markerFound = false;
        });
        
        // é•¿æŒ‰é‡ç½®
        let resetTimer;
        scene.addEventListener('touchstart', function() {
            resetTimer = setTimeout(resetAll, 2000);
        });
        
        scene.addEventListener('touchend', function() {
            clearTimeout(resetTimer);
        });
        
        scene.addEventListener('mousedown', function() {
            resetTimer = setTimeout(resetAll, 2000);
        });
        
        scene.addEventListener('mouseup', function() {
            clearTimeout(resetTimer);
        });
        
        function resetAll() {
            if (fixedModel && fixedModel.parentNode) {
                fixedModel.parentNode.removeChild(fixedModel);
                fixedModel = null;
            }
            document.querySelector('#model-on-marker').setAttribute('visible', 'true');
            console.log('ğŸ”„ å·²é‡ç½®');
        }
        
        console.log('æ“ä½œè¯´æ˜:');
        console.log('1. æ‰«æHiroæ ‡è®°');
        console.log('2. ç‚¹å‡»å±å¹•å°†æ¨¡å‹å›ºå®šåœ¨å½“å‰æ ‡è®°ä½ç½®');
        console.log('3. é•¿æŒ‰2ç§’é‡ç½®');
    </script>
</body>
</html>
