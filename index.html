<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>我的持久化WebAR</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden">
    <a-scene embedded arjs vr-mode-ui="enabled: false" renderer="antialias: true;">

        <!-- 主要标记 -->
        <a-marker preset="hiro" id="main-marker">
            <a-entity
                id="floating-model"
                gltf-model="4.glb"
                scale="0.3 0.3 0.3"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 10000"
            ></a-entity>
        </a-marker>

        <!-- 固定在场景中的模型（初始隐藏） -->
        <a-entity
            id="fixed-model"
            gltf-model="4.glb"
            scale="0.3 0.3 0.3"
            position="0 0 -1.5"
            visible="false"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 10000"
        ></a-entity>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // 标记识别时触发
        document.querySelector('#main-marker').addEventListener('markerFound', function() {
            console.log('标记识别成功！');
            
            // 显示固定模型
            const fixedModel = document.querySelector('#fixed-model');
            fixedModel.setAttribute('visible', 'true');
            
            // 隐藏浮动模型（可选）
            const floatingModel = document.querySelector('#floating-model');
            floatingModel.setAttribute('visible', 'false');
        });

        // 标记丢失时保持固定模型显示
        document.querySelector('#main-marker').addEventListener('markerLost', function() {
            console.log('标记丢失，但模型保持显示');
            // 固定模型继续保持显示状态
        });

        // 双击重置
        document.querySelector('a-scene').addEventListener('dblclick', function() {
            const fixedModel = document.querySelector('#fixed-model');
            const floatingModel = document.querySelector('#floating-model');
            
            fixedModel.setAttribute('visible', 'false');
            floatingModel.setAttribute('visible', 'true');
            console.log('已重置，重新扫描标记显示模型');
        });
    </script>
</body>
</html>
